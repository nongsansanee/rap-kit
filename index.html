<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>mr.melody Rap Kit</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    
    <div class="keys">
        <div data-loop data-keyCode="49" class="key loop">
            <kbd>1</kbd>
            <span class="sound">l1</span>
        </div>
    </div><!-- loops container -->
  
    <div class="keys">
        <div data-keyCode="78" class="key">
            <kbd>N</kbd>
            <span class="sound">nong</span>
        </div>
        <div data-keyCode="69" class="key">
            <kbd>E</kbd>
            <span class="sound">e</span>
        </div>
        <div data-keyCode="83" class="key">
            <kbd>S</kbd>
            <span class="sound">nee</span>
        </div>
        <div data-keyCode="80" class="key">
            <kbd>P</kbd>
            <span class="sound">nan</span>
        </div>
        <div data-keyCode="70" class="key">
            <kbd>F</kbd>
            <span class="sound">fon</span>
        </div>
        <div data-keyCode="79" class="key">
            <kbd>O</kbd>
            <span class="sound">or</span>
        </div>
        <div data-keyCode="68" class="key">
            <kbd>D</kbd>
            <span class="sound">dok</span>
        </div>
        <div data-keyCode="72" class="key">
            <kbd>H</kbd>
            <span class="sound">hia</span>
        </div>
        <div data-keyCode="65" class="key">
            <kbd>A</kbd>
            <span class="sound">sut</span>
        </div>
    </div><!-- sounds container -->

    <!-- loop audio -->
    <audio loop data-loop data-keyCode="49" src="sounds/rap-kit-loop.wav"></audio>

    <!-- sound audio -->
    <audio data-keyCode="78" src="sounds/nong.wav"></audio>
    <audio data-keyCode="83" src="sounds/nee.wav"></audio>
    <audio data-keyCode="80" src="sounds/nan.wav"></audio>
    <audio data-keyCode="70" src="sounds/fon.wav"></audio>
    <audio data-keyCode="69" src="sounds/e.wav"></audio>
    <audio data-keyCode="68" src="sounds/dok.wav"></audio>
    <audio data-keyCode="72" src="sounds/hia.wav"></audio>
    <audio data-keyCode="65" src="sounds/sut.wav"></audio>
    <audio data-keyCode="79" src="sounds/or.wav"></audio>
</body>
<script>

    function playSound(e){
        const key = document.querySelector( `.key[data-keyCode="${e.keyCode}"`);
       const audio = document.querySelector( `audio[data-keyCode="${e.keyCode}"`);
       if(!key)  return;
        const applyClass = key.classList.contains("loop") ? "looping" : "playing";

       if( applyClass == "looping" ){
           if(!audio.paused){
               audio.pause();
               key.classList.remove("looping");
               return;
           }
           key.classList.add("looping");
           audio.volumn = 2;
       }

       key.classList.add(applyClass);

       audio.currentTime=0;
       audio.play();
    }

   window.addEventListener("keydown",playSound);


   function removeClass(e){
      if(e.propertyName != "transform"  || this.classList.contains("loop")){
                    return;
                }
                this.classList.remove("playing");
    
   }

    const keys = document.querySelectorAll(".key");
    // keys.forEach(function(key){
    //     key.addEventListener("transitionend",removeClass);
          
    // });

    keys.forEach(key => {
        key.addEventListener("transitionend",removeClass)
    });
</script>
</html>
